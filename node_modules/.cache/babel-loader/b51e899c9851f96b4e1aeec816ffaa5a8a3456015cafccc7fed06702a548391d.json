{"ast":null,"code":"import React from'react';import{Navigate,useLocation}from'react-router-dom';import{useAuth}from'../../context/AuthContext';import LoadingSpinner from'./LoadingSpinner';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const ProtectedRoute=_ref=>{let{children,allowedRoles=[],requiredPermissions=[]}=_ref;const{user,loading}=useAuth();const location=useLocation();// Show loading spinner while checking authentication\nif(loading){return/*#__PURE__*/_jsx(LoadingSpinner,{fullScreen:true,text:\"Checking authentication...\"});}// Redirect to login if not authenticated\nif(!user){return/*#__PURE__*/_jsx(Navigate,{to:\"/login\",state:{from:location},replace:true});}// Check role-based access\nif(allowedRoles.length>0&&!allowedRoles.includes(user.role)){return/*#__PURE__*/_jsx(\"div\",{className:\"container mt-5\",children:/*#__PURE__*/_jsx(\"div\",{className:\"row justify-content-center\",children:/*#__PURE__*/_jsx(\"div\",{className:\"col-md-6\",children:/*#__PURE__*/_jsx(\"div\",{className:\"card\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"card-body text-center\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-shield-exclamation text-warning\",style:{fontSize:'3rem'}}),/*#__PURE__*/_jsx(\"h4\",{className:\"mt-3\",children:\"Access Denied\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-muted\",children:\"You don't have permission to access this page.\"}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-primary\",onClick:()=>window.history.back(),children:\"Go Back\"})]})})})})});}// Check permission-based access\nif(requiredPermissions.length>0){const hasAllPermissions=requiredPermissions.every(permission=>{var _user$permissions;return(_user$permissions=user.permissions)===null||_user$permissions===void 0?void 0:_user$permissions.includes(permission);});if(!hasAllPermissions){return/*#__PURE__*/_jsx(\"div\",{className:\"container mt-5\",children:/*#__PURE__*/_jsx(\"div\",{className:\"row justify-content-center\",children:/*#__PURE__*/_jsx(\"div\",{className:\"col-md-6\",children:/*#__PURE__*/_jsx(\"div\",{className:\"card\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"card-body text-center\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-shield-exclamation text-warning\",style:{fontSize:'3rem'}}),/*#__PURE__*/_jsx(\"h4\",{className:\"mt-3\",children:\"Insufficient Permissions\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-muted\",children:\"You don't have the required permissions to access this page.\"}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-primary\",onClick:()=>window.history.back(),children:\"Go Back\"})]})})})})});}}// Render children if all checks pass\nreturn children;};export default ProtectedRoute;","map":{"version":3,"names":["React","Navigate","useLocation","useAuth","LoadingSpinner","jsx","_jsx","jsxs","_jsxs","ProtectedRoute","_ref","children","allowedRoles","requiredPermissions","user","loading","location","fullScreen","text","to","state","from","replace","length","includes","role","className","style","fontSize","onClick","window","history","back","hasAllPermissions","every","permission","_user$permissions","permissions"],"sources":["C:/Users/Baap/Desktop/campus-event-management/campus-event-frontend/src/components/common/ProtectedRoute.js"],"sourcesContent":["import React from 'react';\r\nimport { Navigate, useLocation } from 'react-router-dom';\r\nimport { useAuth } from '../../context/AuthContext';\r\nimport LoadingSpinner from './LoadingSpinner';\r\n\r\nconst ProtectedRoute = ({ children, allowedRoles = [], requiredPermissions = [] }) => {\r\n  const { user, loading } = useAuth();\r\n  const location = useLocation();\r\n\r\n  // Show loading spinner while checking authentication\r\n  if (loading) {\r\n    return <LoadingSpinner fullScreen text=\"Checking authentication...\" />;\r\n  }\r\n\r\n  // Redirect to login if not authenticated\r\n  if (!user) {\r\n    return <Navigate to=\"/login\" state={{ from: location }} replace />;\r\n  }\r\n\r\n  // Check role-based access\r\n  if (allowedRoles.length > 0 && !allowedRoles.includes(user.role)) {\r\n    return (\r\n      <div className=\"container mt-5\">\r\n        <div className=\"row justify-content-center\">\r\n          <div className=\"col-md-6\">\r\n            <div className=\"card\">\r\n              <div className=\"card-body text-center\">\r\n                <i className=\"bi bi-shield-exclamation text-warning\" style={{ fontSize: '3rem' }}></i>\r\n                <h4 className=\"mt-3\">Access Denied</h4>\r\n                <p className=\"text-muted\">\r\n                  You don't have permission to access this page.\r\n                </p>\r\n                <button \r\n                  className=\"btn btn-primary\"\r\n                  onClick={() => window.history.back()}\r\n                >\r\n                  Go Back\r\n                </button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  // Check permission-based access\r\n  if (requiredPermissions.length > 0) {\r\n    const hasAllPermissions = requiredPermissions.every(permission => \r\n      user.permissions?.includes(permission)\r\n    );\r\n\r\n    if (!hasAllPermissions) {\r\n      return (\r\n        <div className=\"container mt-5\">\r\n          <div className=\"row justify-content-center\">\r\n            <div className=\"col-md-6\">\r\n              <div className=\"card\">\r\n                <div className=\"card-body text-center\">\r\n                  <i className=\"bi bi-shield-exclamation text-warning\" style={{ fontSize: '3rem' }}></i>\r\n                  <h4 className=\"mt-3\">Insufficient Permissions</h4>\r\n                  <p className=\"text-muted\">\r\n                    You don't have the required permissions to access this page.\r\n                  </p>\r\n                  <button \r\n                    className=\"btn btn-primary\"\r\n                    onClick={() => window.history.back()}\r\n                  >\r\n                    Go Back\r\n                  </button>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      );\r\n    }\r\n  }\r\n\r\n  // Render children if all checks pass\r\n  return children;\r\n};\r\n\r\nexport default ProtectedRoute;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}