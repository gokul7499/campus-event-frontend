{"ast":null,"code":"import _objectSpread from\"C:/Users/Baap/Desktop/campus-event-management/campus-event-frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect}from'react';import{Row,Col,Card,Table,Badge,Form,Button}from'react-bootstrap';import{toast}from'react-toastify';import axios from'../../utils/axios';import LoadingSpinner from'../../components/common/LoadingSpinner';import AdminLayout from'../../components/admin/AdminLayout';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const AdminAnalyticsPage=()=>{const[loading,setLoading]=useState(true);const[analytics,setAnalytics]=useState({users:{},events:{},registrations:{},categories:{},notifications:{}});const[dateRange,setDateRange]=useState({startDate:new Date(new Date().getFullYear(),new Date().getMonth(),1).toISOString().split('T')[0],endDate:new Date().toISOString().split('T')[0]});useEffect(()=>{fetchAnalytics();},[dateRange]);const fetchAnalytics=async()=>{try{setLoading(true);const[userStatsRes,eventStatsRes,registrationStatsRes,categoryStatsRes,notificationStatsRes]=await Promise.allSettled([axios.get('/api/users/stats'),axios.get('/api/events/admin/stats'),axios.get('/api/registrations/admin/stats'),axios.get('/api/categories/admin/stats'),axios.get('/api/notifications/admin/stats')]);if(userStatsRes.status==='fulfilled'){setAnalytics(prev=>_objectSpread(_objectSpread({},prev),{},{users:userStatsRes.value.data.data}));}if(eventStatsRes.status==='fulfilled'){setAnalytics(prev=>_objectSpread(_objectSpread({},prev),{},{events:eventStatsRes.value.data.data}));}if(registrationStatsRes.status==='fulfilled'){setAnalytics(prev=>_objectSpread(_objectSpread({},prev),{},{registrations:registrationStatsRes.value.data.data}));}if(categoryStatsRes.status==='fulfilled'){setAnalytics(prev=>_objectSpread(_objectSpread({},prev),{},{categories:categoryStatsRes.value.data.data}));}if(notificationStatsRes.status==='fulfilled'){setAnalytics(prev=>_objectSpread(_objectSpread({},prev),{},{notifications:notificationStatsRes.value.data.data}));}}catch(error){console.error('Error fetching analytics:',error);toast.error('Failed to load analytics data');}finally{setLoading(false);}};if(loading){return/*#__PURE__*/_jsx(LoadingSpinner,{});}return/*#__PURE__*/_jsxs(AdminLayout,{children:[/*#__PURE__*/_jsx(Row,{className:\"mb-4\",children:/*#__PURE__*/_jsx(Col,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex justify-content-between align-items-center\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h1\",{className:\"mb-1\",children:\"Analytics Dashboard\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-muted mb-0\",children:\"System performance and usage analytics\"})]}),/*#__PURE__*/_jsxs(Button,{variant:\"outline-primary\",onClick:fetchAnalytics,children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-arrow-clockwise me-2\"}),\"Refresh\"]})]})})}),/*#__PURE__*/_jsx(Row,{className:\"mb-4\",children:/*#__PURE__*/_jsx(Col,{children:/*#__PURE__*/_jsx(Card,{className:\"border-0 shadow-sm\",children:/*#__PURE__*/_jsx(Card.Body,{children:/*#__PURE__*/_jsxs(Row,{className:\"align-items-end\",children:[/*#__PURE__*/_jsxs(Col,{md:3,children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Start Date\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"date\",value:dateRange.startDate,onChange:e=>setDateRange(prev=>_objectSpread(_objectSpread({},prev),{},{startDate:e.target.value}))})]}),/*#__PURE__*/_jsxs(Col,{md:3,children:[/*#__PURE__*/_jsx(Form.Label,{children:\"End Date\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"date\",value:dateRange.endDate,onChange:e=>setDateRange(prev=>_objectSpread(_objectSpread({},prev),{},{endDate:e.target.value}))})]}),/*#__PURE__*/_jsx(Col,{md:6,children:/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex gap-2\",children:[/*#__PURE__*/_jsx(Button,{variant:\"outline-secondary\",onClick:()=>setDateRange({startDate:new Date(new Date().setDate(new Date().getDate()-7)).toISOString().split('T')[0],endDate:new Date().toISOString().split('T')[0]}),children:\"Last 7 Days\"}),/*#__PURE__*/_jsx(Button,{variant:\"outline-secondary\",onClick:()=>setDateRange({startDate:new Date(new Date().setDate(new Date().getDate()-30)).toISOString().split('T')[0],endDate:new Date().toISOString().split('T')[0]}),children:\"Last 30 Days\"}),/*#__PURE__*/_jsx(Button,{variant:\"outline-secondary\",onClick:()=>setDateRange({startDate:new Date(new Date().getFullYear(),new Date().getMonth(),1).toISOString().split('T')[0],endDate:new Date().toISOString().split('T')[0]}),children:\"This Month\"})]})})]})})})})}),/*#__PURE__*/_jsxs(Row,{className:\"mb-4\",children:[/*#__PURE__*/_jsx(Col,{lg:3,md:6,className:\"mb-3\",children:/*#__PURE__*/_jsx(Card,{className:\"border-0 shadow-sm h-100\",children:/*#__PURE__*/_jsxs(Card.Body,{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"bg-primary bg-opacity-10 rounded-circle d-inline-flex align-items-center justify-content-center mb-3\",style:{width:'60px',height:'60px'},children:/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-people text-primary\",style:{fontSize:'1.5rem'}})}),/*#__PURE__*/_jsx(\"h3\",{className:\"mb-1\",children:analytics.users.totalUsers||0}),/*#__PURE__*/_jsx(\"p\",{className:\"text-muted mb-0\",children:\"Total Users\"}),/*#__PURE__*/_jsxs(\"small\",{className:\"text-success\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-arrow-up\"}),\" \",analytics.users.newUsersThisMonth||0,\" this month\"]})]})})}),/*#__PURE__*/_jsx(Col,{lg:3,md:6,className:\"mb-3\",children:/*#__PURE__*/_jsx(Card,{className:\"border-0 shadow-sm h-100\",children:/*#__PURE__*/_jsxs(Card.Body,{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"bg-success bg-opacity-10 rounded-circle d-inline-flex align-items-center justify-content-center mb-3\",style:{width:'60px',height:'60px'},children:/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-calendar-event text-success\",style:{fontSize:'1.5rem'}})}),/*#__PURE__*/_jsx(\"h3\",{className:\"mb-1\",children:analytics.events.totalEvents||0}),/*#__PURE__*/_jsx(\"p\",{className:\"text-muted mb-0\",children:\"Total Events\"}),/*#__PURE__*/_jsxs(\"small\",{className:\"text-info\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-clock\"}),\" \",analytics.events.upcomingEvents||0,\" upcoming\"]})]})})}),/*#__PURE__*/_jsx(Col,{lg:3,md:6,className:\"mb-3\",children:/*#__PURE__*/_jsx(Card,{className:\"border-0 shadow-sm h-100\",children:/*#__PURE__*/_jsxs(Card.Body,{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"bg-warning bg-opacity-10 rounded-circle d-inline-flex align-items-center justify-content-center mb-3\",style:{width:'60px',height:'60px'},children:/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-person-check text-warning\",style:{fontSize:'1.5rem'}})}),/*#__PURE__*/_jsx(\"h3\",{className:\"mb-1\",children:analytics.registrations.totalRegistrations||0}),/*#__PURE__*/_jsx(\"p\",{className:\"text-muted mb-0\",children:\"Total Registrations\"}),/*#__PURE__*/_jsx(\"small\",{className:\"text-muted\",children:\"All time\"})]})})}),/*#__PURE__*/_jsx(Col,{lg:3,md:6,className:\"mb-3\",children:/*#__PURE__*/_jsx(Card,{className:\"border-0 shadow-sm h-100\",children:/*#__PURE__*/_jsxs(Card.Body,{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"bg-info bg-opacity-10 rounded-circle d-inline-flex align-items-center justify-content-center mb-3\",style:{width:'60px',height:'60px'},children:/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-bell text-info\",style:{fontSize:'1.5rem'}})}),/*#__PURE__*/_jsx(\"h3\",{className:\"mb-1\",children:analytics.notifications.totalNotifications||0}),/*#__PURE__*/_jsx(\"p\",{className:\"text-muted mb-0\",children:\"Notifications Sent\"}),/*#__PURE__*/_jsx(\"small\",{className:\"text-muted\",children:\"All time\"})]})})})]}),/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{lg:6,className:\"mb-4\",children:/*#__PURE__*/_jsxs(Card,{className:\"border-0 shadow-sm h-100\",children:[/*#__PURE__*/_jsx(Card.Header,{className:\"bg-white border-0 py-3\",children:/*#__PURE__*/_jsx(\"h5\",{className:\"mb-0\",children:\"Events by Category\"})}),/*#__PURE__*/_jsx(Card.Body,{children:analytics.events.eventsByCategory&&analytics.events.eventsByCategory.length>0?/*#__PURE__*/_jsxs(Table,{responsive:true,className:\"mb-0\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"Category\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Events\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Percentage\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:analytics.events.eventsByCategory.map(category=>/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:category._id}),/*#__PURE__*/_jsx(\"td\",{children:category.count}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex align-items-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"progress flex-grow-1 me-2\",style:{height:'8px'},children:/*#__PURE__*/_jsx(\"div\",{className:\"progress-bar bg-primary\",style:{width:\"\".concat(category.count/analytics.events.totalEvents*100,\"%\")}})}),/*#__PURE__*/_jsxs(\"small\",{className:\"text-muted\",children:[(category.count/analytics.events.totalEvents*100).toFixed(1),\"%\"]})]})})]},category._id))})]}):/*#__PURE__*/_jsx(\"div\",{className:\"text-center py-4\",children:/*#__PURE__*/_jsx(\"p\",{className:\"text-muted\",children:\"No category data available\"})})})]})}),/*#__PURE__*/_jsx(Col,{lg:6,className:\"mb-4\",children:/*#__PURE__*/_jsxs(Card,{className:\"border-0 shadow-sm h-100\",children:[/*#__PURE__*/_jsx(Card.Header,{className:\"bg-white border-0 py-3\",children:/*#__PURE__*/_jsx(\"h5\",{className:\"mb-0\",children:\"Registration Status\"})}),/*#__PURE__*/_jsx(Card.Body,{children:analytics.registrations.statusStats&&analytics.registrations.statusStats.length>0?/*#__PURE__*/_jsxs(Table,{responsive:true,className:\"mb-0\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"Status\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Count\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Percentage\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:analytics.registrations.statusStats.map(status=>/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(Badge,{bg:status._id==='confirmed'?'success':status._id==='pending'?'warning':status._id==='cancelled'?'danger':'secondary',children:status._id})}),/*#__PURE__*/_jsx(\"td\",{children:status.count}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex align-items-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"progress flex-grow-1 me-2\",style:{height:'8px'},children:/*#__PURE__*/_jsx(\"div\",{className:\"progress-bar bg-success\",style:{width:\"\".concat(status.count/analytics.registrations.totalRegistrations*100,\"%\")}})}),/*#__PURE__*/_jsxs(\"small\",{className:\"text-muted\",children:[(status.count/analytics.registrations.totalRegistrations*100).toFixed(1),\"%\"]})]})})]},status._id))})]}):/*#__PURE__*/_jsx(\"div\",{className:\"text-center py-4\",children:/*#__PURE__*/_jsx(\"p\",{className:\"text-muted\",children:\"No registration data available\"})})})]})})]}),/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{lg:6,className:\"mb-4\",children:/*#__PURE__*/_jsxs(Card,{className:\"border-0 shadow-sm h-100\",children:[/*#__PURE__*/_jsx(Card.Header,{className:\"bg-white border-0 py-3\",children:/*#__PURE__*/_jsx(\"h5\",{className:\"mb-0\",children:\"User Role Distribution\"})}),/*#__PURE__*/_jsx(Card.Body,{children:analytics.users.roleStats&&analytics.users.roleStats.length>0?analytics.users.roleStats.map(role=>/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex justify-content-between align-items-center mb-3\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex align-items-center\",children:[/*#__PURE__*/_jsx(Badge,{bg:role._id==='admin'?'danger':role._id==='organizer'?'warning':'info',className:\"me-3\",children:role._id}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-capitalize\",children:[role._id,\"s\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex align-items-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"progress me-3\",style:{width:'100px',height:'8px'},children:/*#__PURE__*/_jsx(\"div\",{className:\"progress-bar bg-primary\",style:{width:\"\".concat(role.count/analytics.users.totalUsers*100,\"%\")}})}),/*#__PURE__*/_jsx(\"span\",{className:\"fw-bold\",children:role.count})]})]},role._id)):/*#__PURE__*/_jsx(\"div\",{className:\"text-center py-4\",children:/*#__PURE__*/_jsx(\"p\",{className:\"text-muted\",children:\"No role data available\"})})})]})}),/*#__PURE__*/_jsx(Col,{lg:6,className:\"mb-4\",children:/*#__PURE__*/_jsxs(Card,{className:\"border-0 shadow-sm h-100\",children:[/*#__PURE__*/_jsx(Card.Header,{className:\"bg-white border-0 py-3\",children:/*#__PURE__*/_jsx(\"h5\",{className:\"mb-0\",children:\"Top Departments\"})}),/*#__PURE__*/_jsx(Card.Body,{children:analytics.users.departmentStats&&analytics.users.departmentStats.length>0?analytics.users.departmentStats.slice(0,8).map(dept=>/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex justify-content-between align-items-center mb-3\",children:[/*#__PURE__*/_jsx(\"span\",{children:dept._id}),/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex align-items-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"progress me-3\",style:{width:'100px',height:'8px'},children:/*#__PURE__*/_jsx(\"div\",{className:\"progress-bar bg-info\",style:{width:\"\".concat(dept.count/analytics.users.totalUsers*100,\"%\")}})}),/*#__PURE__*/_jsx(\"span\",{className:\"fw-bold\",children:dept.count})]})]},dept._id)):/*#__PURE__*/_jsx(\"div\",{className:\"text-center py-4\",children:/*#__PURE__*/_jsx(\"p\",{className:\"text-muted\",children:\"No department data available\"})})})]})})]})]});};export default AdminAnalyticsPage;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}