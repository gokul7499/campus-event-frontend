{"ast":null,"code":"import React,{createContext,useContext,useState,useEffect}from'react';import{io}from'socket.io-client';import{useAuth}from'./AuthContext';import config from'../config/config';import{jsx as _jsx}from\"react/jsx-runtime\";const SocketContext=/*#__PURE__*/createContext();export const SocketProvider=_ref=>{let{children}=_ref;const[socket,setSocket]=useState(null);const[connected,setConnected]=useState(false);const{user}=useAuth();useEffect(()=>{if(user){const newSocket=io(config.socket.url,{auth:{userId:user._id}});// Connection event handlers\nnewSocket.on('connect',()=>{console.log('Socket connected:',newSocket.id);setConnected(true);// Join user's personal room\nnewSocket.emit('join',user._id);});newSocket.on('disconnect',()=>{console.log('Socket disconnected');setConnected(false);});newSocket.on('connect_error',error=>{console.error('Socket connection error:',error);setConnected(false);});setSocket(newSocket);return()=>{newSocket.close();setSocket(null);setConnected(false);};}else{if(socket){socket.close();setSocket(null);setConnected(false);}}},[user,socket]);// Send notification\nconst sendNotification=data=>{if(socket&&connected){socket.emit('send_notification',data);}};// Send event update\nconst sendEventUpdate=data=>{if(socket&&connected){socket.emit('event_update',data);}};// Subscribe to notifications\nconst onNotification=callback=>{if(socket){socket.on('notification',callback);// Return cleanup function\nreturn()=>socket.off('notification',callback);}};// Subscribe to event updates\nconst onEventUpdate=callback=>{if(socket){socket.on('event_updated',callback);// Return cleanup function\nreturn()=>socket.off('event_updated',callback);}};// Subscribe to real-time registration updates\nconst onRegistrationUpdate=callback=>{if(socket){socket.on('registration_update',callback);// Return cleanup function\nreturn()=>socket.off('registration_update',callback);}};// Join event room (for real-time updates during events)\nconst joinEventRoom=eventId=>{if(socket&&connected){socket.emit('join_event',eventId);}};// Leave event room\nconst leaveEventRoom=eventId=>{if(socket&&connected){socket.emit('leave_event',eventId);}};// Send message to event room\nconst sendEventMessage=(eventId,message)=>{if(socket&&connected){socket.emit('event_message',{eventId,message});}};// Subscribe to event messages\nconst onEventMessage=callback=>{if(socket){socket.on('event_message',callback);// Return cleanup function\nreturn()=>socket.off('event_message',callback);}};const value={socket,connected,sendNotification,sendEventUpdate,onNotification,onEventUpdate,onRegistrationUpdate,joinEventRoom,leaveEventRoom,sendEventMessage,onEventMessage};return/*#__PURE__*/_jsx(SocketContext.Provider,{value:value,children:children});};export const useSocket=()=>{const context=useContext(SocketContext);if(!context){throw new Error('useSocket must be used within a SocketProvider');}return context;};export default SocketContext;","map":{"version":3,"names":["React","createContext","useContext","useState","useEffect","io","useAuth","config","jsx","_jsx","SocketContext","SocketProvider","_ref","children","socket","setSocket","connected","setConnected","user","newSocket","url","auth","userId","_id","on","console","log","id","emit","error","close","sendNotification","data","sendEventUpdate","onNotification","callback","off","onEventUpdate","onRegistrationUpdate","joinEventRoom","eventId","leaveEventRoom","sendEventMessage","message","onEventMessage","value","Provider","useSocket","context","Error"],"sources":["C:/Users/Baap/Desktop/campus-event-management/campus-event-frontend/src/context/SocketContext.js"],"sourcesContent":["import React, { createContext, useContext, useState, useEffect } from 'react';\r\nimport { io } from 'socket.io-client';\r\nimport { useAuth } from './AuthContext';\r\nimport config from '../config/config';\r\n\r\nconst SocketContext = createContext();\r\n\r\nexport const SocketProvider = ({ children }) => {\r\n  const [socket, setSocket] = useState(null);\r\n  const [connected, setConnected] = useState(false);\r\n  const { user } = useAuth();\r\n\r\n  useEffect(() => {\r\n    if (user) {\r\n      \r\n      const newSocket = io(config.socket.url, {\r\n        auth: {\r\n          userId: user._id\r\n        }\r\n      });\r\n\r\n      // Connection event handlers\r\n      newSocket.on('connect', () => {\r\n        console.log('Socket connected:', newSocket.id);\r\n        setConnected(true);\r\n        \r\n        // Join user's personal room\r\n        newSocket.emit('join', user._id);\r\n      });\r\n\r\n      newSocket.on('disconnect', () => {\r\n        console.log('Socket disconnected');\r\n        setConnected(false);\r\n      });\r\n\r\n      newSocket.on('connect_error', (error) => {\r\n        console.error('Socket connection error:', error);\r\n        setConnected(false);\r\n      });\r\n\r\n      setSocket(newSocket);\r\n\r\n      return () => {\r\n        newSocket.close();\r\n        setSocket(null);\r\n        setConnected(false);\r\n      };\r\n    } else {\r\n      \r\n      if (socket) {\r\n        socket.close();\r\n        setSocket(null);\r\n        setConnected(false);\r\n      }\r\n    }\r\n  }, [user, socket]);\r\n\r\n  // Send notification\r\n  const sendNotification = (data) => {\r\n    if (socket && connected) {\r\n      socket.emit('send_notification', data);\r\n    }\r\n  };\r\n\r\n  // Send event update\r\n  const sendEventUpdate = (data) => {\r\n    if (socket && connected) {\r\n      socket.emit('event_update', data);\r\n    }\r\n  };\r\n\r\n  // Subscribe to notifications\r\n  const onNotification = (callback) => {\r\n    if (socket) {\r\n      socket.on('notification', callback);\r\n      \r\n      // Return cleanup function\r\n      return () => socket.off('notification', callback);\r\n    }\r\n  };\r\n\r\n  // Subscribe to event updates\r\n  const onEventUpdate = (callback) => {\r\n    if (socket) {\r\n      socket.on('event_updated', callback);\r\n      \r\n      // Return cleanup function\r\n      return () => socket.off('event_updated', callback);\r\n    }\r\n  };\r\n\r\n  // Subscribe to real-time registration updates\r\n  const onRegistrationUpdate = (callback) => {\r\n    if (socket) {\r\n      socket.on('registration_update', callback);\r\n      \r\n      // Return cleanup function\r\n      return () => socket.off('registration_update', callback);\r\n    }\r\n  };\r\n\r\n  // Join event room (for real-time updates during events)\r\n  const joinEventRoom = (eventId) => {\r\n    if (socket && connected) {\r\n      socket.emit('join_event', eventId);\r\n    }\r\n  };\r\n\r\n  // Leave event room\r\n  const leaveEventRoom = (eventId) => {\r\n    if (socket && connected) {\r\n      socket.emit('leave_event', eventId);\r\n    }\r\n  };\r\n\r\n  // Send message to event room\r\n  const sendEventMessage = (eventId, message) => {\r\n    if (socket && connected) {\r\n      socket.emit('event_message', { eventId, message });\r\n    }\r\n  };\r\n\r\n  // Subscribe to event messages\r\n  const onEventMessage = (callback) => {\r\n    if (socket) {\r\n      socket.on('event_message', callback);\r\n      \r\n      // Return cleanup function\r\n      return () => socket.off('event_message', callback);\r\n    }\r\n  };\r\n\r\n  const value = {\r\n    socket,\r\n    connected,\r\n    sendNotification,\r\n    sendEventUpdate,\r\n    onNotification,\r\n    onEventUpdate,\r\n    onRegistrationUpdate,\r\n    joinEventRoom,\r\n    leaveEventRoom,\r\n    sendEventMessage,\r\n    onEventMessage\r\n  };\r\n\r\n  return (\r\n    <SocketContext.Provider value={value}>\r\n      {children}\r\n    </SocketContext.Provider>\r\n  );\r\n};\r\n\r\nexport const useSocket = () => {\r\n  const context = useContext(SocketContext);\r\n  if (!context) {\r\n    throw new Error('useSocket must be used within a SocketProvider');\r\n  }\r\n  return context;\r\n};\r\n\r\nexport default SocketContext;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}