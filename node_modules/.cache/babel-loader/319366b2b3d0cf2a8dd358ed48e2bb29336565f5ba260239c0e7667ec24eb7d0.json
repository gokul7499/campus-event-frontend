{"ast":null,"code":"import _objectSpread from\"C:/Users/Baap/Desktop/campus-event-management/campus-event-frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect}from'react';import{Row,Col,Card,Button,Badge,Table,Spinner,Alert}from'react-bootstrap';import{Link}from'react-router-dom';import{toast}from'react-toastify';import axios from'../../utils/axios';import{useAuth}from'../../context/AuthContext';import LoadingSpinner from'../../components/common/LoadingSpinner';import AdminLayout from'../../components/admin/AdminLayout';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const AdminDashboard=()=>{const{user}=useAuth();const[loading,setLoading]=useState(true);const[stats,setStats]=useState({users:{},events:{},registrations:{},categories:{},notifications:{}});const[recentUsers,setRecentUsers]=useState([]);const[recentEvents,setRecentEvents]=useState([]);const[error,setError]=useState(null);useEffect(()=>{fetchDashboardData();},[]);const fetchDashboardData=async()=>{try{setLoading(true);setError(null);// Fetch all statistics in parallel\nconst[userStatsRes,eventStatsRes,registrationStatsRes,categoryStatsRes,notificationStatsRes,recentUsersRes,recentEventsRes]=await Promise.allSettled([axios.get('/api/users/stats'),axios.get('/api/events/admin/stats'),axios.get('/api/registrations/admin/stats'),axios.get('/api/categories/admin/stats'),axios.get('/api/notifications/admin/stats'),axios.get('/api/users?limit=5&sortBy=createdAt&sortOrder=desc'),axios.get('/api/events?limit=5&sortBy=createdAt&sortOrder=desc')]);// Process results\nif(userStatsRes.status==='fulfilled'){setStats(prev=>_objectSpread(_objectSpread({},prev),{},{users:userStatsRes.value.data.data}));}if(eventStatsRes.status==='fulfilled'){setStats(prev=>_objectSpread(_objectSpread({},prev),{},{events:eventStatsRes.value.data.data}));}if(registrationStatsRes.status==='fulfilled'){setStats(prev=>_objectSpread(_objectSpread({},prev),{},{registrations:registrationStatsRes.value.data.data}));}if(categoryStatsRes.status==='fulfilled'){setStats(prev=>_objectSpread(_objectSpread({},prev),{},{categories:categoryStatsRes.value.data.data}));}if(notificationStatsRes.status==='fulfilled'){setStats(prev=>_objectSpread(_objectSpread({},prev),{},{notifications:notificationStatsRes.value.data.data}));}if(recentUsersRes.status==='fulfilled'){setRecentUsers(recentUsersRes.value.data.data||[]);}if(recentEventsRes.status==='fulfilled'){setRecentEvents(recentEventsRes.value.data.data||[]);}}catch(error){console.error('Error fetching dashboard data:',error);setError('Failed to load dashboard data');toast.error('Failed to load dashboard data');}finally{setLoading(false);}};if(loading){return/*#__PURE__*/_jsx(LoadingSpinner,{});}return/*#__PURE__*/_jsxs(AdminLayout,{children:[/*#__PURE__*/_jsx(Row,{className:\"mb-4\",children:/*#__PURE__*/_jsx(Col,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex justify-content-between align-items-center\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h1\",{className:\"mb-1\",children:\"Admin Dashboard\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-muted mb-0\",children:[\"Welcome back, \",user===null||user===void 0?void 0:user.firstName,\"! Here's what's happening.\"]})]}),/*#__PURE__*/_jsxs(Button,{variant:\"outline-primary\",onClick:fetchDashboardData,disabled:loading,children:[loading?/*#__PURE__*/_jsx(Spinner,{size:\"sm\"}):/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-arrow-clockwise me-2\"}),\"Refresh\"]})]})})}),error&&/*#__PURE__*/_jsx(Alert,{variant:\"danger\",dismissible:true,onClose:()=>setError(null),children:error}),/*#__PURE__*/_jsxs(Row,{className:\"mb-4\",children:[/*#__PURE__*/_jsx(Col,{lg:3,md:6,className:\"mb-3\",children:/*#__PURE__*/_jsx(Card,{className:\"h-100 border-0 shadow-sm\",children:/*#__PURE__*/_jsx(Card.Body,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex align-items-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"flex-shrink-0\",children:/*#__PURE__*/_jsx(\"div\",{className:\"bg-primary bg-opacity-10 rounded-3 p-3\",children:/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-people text-primary\",style:{fontSize:'1.5rem'}})})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-grow-1 ms-3\",children:[/*#__PURE__*/_jsx(\"h6\",{className:\"text-muted mb-1\",children:\"Total Users\"}),/*#__PURE__*/_jsx(\"h3\",{className:\"mb-0\",children:stats.users.totalUsers||0}),/*#__PURE__*/_jsxs(\"small\",{className:\"text-success\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-arrow-up\"}),\" \",stats.users.newUsersThisMonth||0,\" this month\"]})]})]})})})}),/*#__PURE__*/_jsx(Col,{lg:3,md:6,className:\"mb-3\",children:/*#__PURE__*/_jsx(Card,{className:\"h-100 border-0 shadow-sm\",children:/*#__PURE__*/_jsx(Card.Body,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex align-items-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"flex-shrink-0\",children:/*#__PURE__*/_jsx(\"div\",{className:\"bg-success bg-opacity-10 rounded-3 p-3\",children:/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-calendar-event text-success\",style:{fontSize:'1.5rem'}})})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-grow-1 ms-3\",children:[/*#__PURE__*/_jsx(\"h6\",{className:\"text-muted mb-1\",children:\"Total Events\"}),/*#__PURE__*/_jsx(\"h3\",{className:\"mb-0\",children:stats.events.totalEvents||0}),/*#__PURE__*/_jsxs(\"small\",{className:\"text-info\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-clock\"}),\" \",stats.events.upcomingEvents||0,\" upcoming\"]})]})]})})})}),/*#__PURE__*/_jsx(Col,{lg:3,md:6,className:\"mb-3\",children:/*#__PURE__*/_jsx(Card,{className:\"h-100 border-0 shadow-sm\",children:/*#__PURE__*/_jsx(Card.Body,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex align-items-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"flex-shrink-0\",children:/*#__PURE__*/_jsx(\"div\",{className:\"bg-warning bg-opacity-10 rounded-3 p-3\",children:/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-person-check text-warning\",style:{fontSize:'1.5rem'}})})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-grow-1 ms-3\",children:[/*#__PURE__*/_jsx(\"h6\",{className:\"text-muted mb-1\",children:\"Registrations\"}),/*#__PURE__*/_jsx(\"h3\",{className:\"mb-0\",children:stats.registrations.totalRegistrations||0}),/*#__PURE__*/_jsx(\"small\",{className:\"text-muted\",children:\"All time\"})]})]})})})}),/*#__PURE__*/_jsx(Col,{lg:3,md:6,className:\"mb-3\",children:/*#__PURE__*/_jsx(Card,{className:\"h-100 border-0 shadow-sm\",children:/*#__PURE__*/_jsx(Card.Body,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex align-items-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"flex-shrink-0\",children:/*#__PURE__*/_jsx(\"div\",{className:\"bg-info bg-opacity-10 rounded-3 p-3\",children:/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-folder text-info\",style:{fontSize:'1.5rem'}})})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-grow-1 ms-3\",children:[/*#__PURE__*/_jsx(\"h6\",{className:\"text-muted mb-1\",children:\"Categories\"}),/*#__PURE__*/_jsx(\"h3\",{className:\"mb-0\",children:stats.categories.totalCategories||0}),/*#__PURE__*/_jsx(\"small\",{className:\"text-muted\",children:\"Active\"})]})]})})})})]}),/*#__PURE__*/_jsx(Row,{className:\"mb-4\",children:/*#__PURE__*/_jsx(Col,{children:/*#__PURE__*/_jsxs(Card,{className:\"border-0 shadow-sm\",children:[/*#__PURE__*/_jsx(Card.Header,{className:\"bg-white border-0 py-3\",children:/*#__PURE__*/_jsx(\"h5\",{className:\"mb-0\",children:\"Quick Actions\"})}),/*#__PURE__*/_jsx(Card.Body,{children:/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{lg:3,md:6,className:\"mb-3\",children:/*#__PURE__*/_jsx(\"div\",{className:\"d-grid\",children:/*#__PURE__*/_jsxs(Button,{as:Link,to:\"/admin/users\",variant:\"outline-primary\",size:\"lg\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-people me-2\"}),\"Manage Users\"]})})}),/*#__PURE__*/_jsx(Col,{lg:3,md:6,className:\"mb-3\",children:/*#__PURE__*/_jsx(\"div\",{className:\"d-grid\",children:/*#__PURE__*/_jsxs(Button,{as:Link,to:\"/manage-events\",variant:\"outline-success\",size:\"lg\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-calendar-event me-2\"}),\"Manage Events\"]})})}),/*#__PURE__*/_jsx(Col,{lg:3,md:6,className:\"mb-3\",children:/*#__PURE__*/_jsx(\"div\",{className:\"d-grid\",children:/*#__PURE__*/_jsxs(Button,{as:Link,to:\"/manage-categories\",variant:\"outline-warning\",size:\"lg\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-folder me-2\"}),\"Manage Categories\"]})})}),/*#__PURE__*/_jsx(Col,{lg:3,md:6,className:\"mb-3\",children:/*#__PURE__*/_jsx(\"div\",{className:\"d-grid\",children:/*#__PURE__*/_jsxs(Button,{as:Link,to:\"/admin/analytics\",variant:\"outline-info\",size:\"lg\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-graph-up me-2\"}),\"View Analytics\"]})})})]})})]})})}),/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{lg:6,className:\"mb-4\",children:/*#__PURE__*/_jsxs(Card,{className:\"h-100 border-0 shadow-sm\",children:[/*#__PURE__*/_jsxs(Card.Header,{className:\"bg-white border-0 py-3 d-flex justify-content-between align-items-center\",children:[/*#__PURE__*/_jsx(\"h5\",{className:\"mb-0\",children:\"Recent Users\"}),/*#__PURE__*/_jsx(Button,{as:Link,to:\"/admin/users\",variant:\"outline-primary\",size:\"sm\",children:\"View All\"})]}),/*#__PURE__*/_jsx(Card.Body,{className:\"p-0\",children:recentUsers.length>0?/*#__PURE__*/_jsxs(Table,{responsive:true,className:\"mb-0\",children:[/*#__PURE__*/_jsx(\"thead\",{className:\"table-light\",children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"User\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Role\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Department\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Joined\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:recentUsers.map(user=>{var _user$firstName,_user$lastName;return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex align-items-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"avatar-sm bg-primary bg-opacity-10 rounded-circle d-flex align-items-center justify-content-center me-3\",children:/*#__PURE__*/_jsxs(\"span\",{className:\"text-primary fw-bold\",children:[(_user$firstName=user.firstName)===null||_user$firstName===void 0?void 0:_user$firstName.charAt(0),(_user$lastName=user.lastName)===null||_user$lastName===void 0?void 0:_user$lastName.charAt(0)]})}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"h6\",{className:\"mb-0\",children:[user.firstName,\" \",user.lastName]}),/*#__PURE__*/_jsx(\"small\",{className:\"text-muted\",children:user.email})]})]})}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(Badge,{bg:user.role==='admin'?'danger':user.role==='organizer'?'warning':'info',children:user.role})}),/*#__PURE__*/_jsx(\"td\",{children:user.department||'N/A'}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"small\",{className:\"text-muted\",children:new Date(user.createdAt).toLocaleDateString()})})]},user._id);})})]}):/*#__PURE__*/_jsxs(\"div\",{className:\"text-center py-4\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-people text-muted\",style:{fontSize:'2rem'}}),/*#__PURE__*/_jsx(\"p\",{className:\"text-muted mt-2\",children:\"No recent users\"})]})})]})}),/*#__PURE__*/_jsx(Col,{lg:6,className:\"mb-4\",children:/*#__PURE__*/_jsxs(Card,{className:\"h-100 border-0 shadow-sm\",children:[/*#__PURE__*/_jsxs(Card.Header,{className:\"bg-white border-0 py-3 d-flex justify-content-between align-items-center\",children:[/*#__PURE__*/_jsx(\"h5\",{className:\"mb-0\",children:\"Recent Events\"}),/*#__PURE__*/_jsx(Button,{as:Link,to:\"/manage-events\",variant:\"outline-success\",size:\"sm\",children:\"View All\"})]}),/*#__PURE__*/_jsx(Card.Body,{className:\"p-0\",children:recentEvents.length>0?/*#__PURE__*/_jsxs(Table,{responsive:true,className:\"mb-0\",children:[/*#__PURE__*/_jsx(\"thead\",{className:\"table-light\",children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"Event\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Status\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Date\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Registrations\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:recentEvents.map(event=>{var _event$venue;return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h6\",{className:\"mb-0\",children:event.title}),/*#__PURE__*/_jsx(\"small\",{className:\"text-muted\",children:(_event$venue=event.venue)===null||_event$venue===void 0?void 0:_event$venue.name})]})}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(Badge,{bg:event.status==='published'?'success':event.status==='draft'?'warning':event.status==='cancelled'?'danger':'secondary',children:event.status})}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"small\",{className:\"text-muted\",children:new Date(event.startDate).toLocaleDateString()})}),/*#__PURE__*/_jsxs(\"td\",{children:[/*#__PURE__*/_jsx(\"span\",{className:\"fw-bold\",children:event.registrationCount||0}),/*#__PURE__*/_jsxs(\"small\",{className:\"text-muted\",children:[\"/\",event.capacity]})]})]},event._id);})})]}):/*#__PURE__*/_jsxs(\"div\",{className:\"text-center py-4\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-calendar-event text-muted\",style:{fontSize:'2rem'}}),/*#__PURE__*/_jsx(\"p\",{className:\"text-muted mt-2\",children:\"No recent events\"})]})})]})})]}),stats.users.roleStats&&stats.users.roleStats.length>0&&/*#__PURE__*/_jsxs(Row,{className:\"mb-4\",children:[/*#__PURE__*/_jsx(Col,{lg:6,children:/*#__PURE__*/_jsxs(Card,{className:\"border-0 shadow-sm\",children:[/*#__PURE__*/_jsx(Card.Header,{className:\"bg-white border-0 py-3\",children:/*#__PURE__*/_jsx(\"h5\",{className:\"mb-0\",children:\"User Role Distribution\"})}),/*#__PURE__*/_jsx(Card.Body,{children:stats.users.roleStats.map(role=>/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex justify-content-between align-items-center mb-3\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex align-items-center\",children:[/*#__PURE__*/_jsx(Badge,{bg:role._id==='admin'?'danger':role._id==='organizer'?'warning':'info',className:\"me-3\",children:role._id}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-capitalize\",children:[role._id,\"s\"]})]}),/*#__PURE__*/_jsx(\"span\",{className:\"fw-bold\",children:role.count})]},role._id))})]})}),/*#__PURE__*/_jsx(Col,{lg:6,children:/*#__PURE__*/_jsxs(Card,{className:\"border-0 shadow-sm\",children:[/*#__PURE__*/_jsx(Card.Header,{className:\"bg-white border-0 py-3\",children:/*#__PURE__*/_jsx(\"h5\",{className:\"mb-0\",children:\"Top Departments\"})}),/*#__PURE__*/_jsx(Card.Body,{children:stats.users.departmentStats&&stats.users.departmentStats.length>0?stats.users.departmentStats.slice(0,5).map(dept=>/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex justify-content-between align-items-center mb-3\",children:[/*#__PURE__*/_jsx(\"span\",{children:dept._id}),/*#__PURE__*/_jsx(\"span\",{className:\"fw-bold\",children:dept.count})]},dept._id)):/*#__PURE__*/_jsx(\"div\",{className:\"text-center py-3\",children:/*#__PURE__*/_jsx(\"p\",{className:\"text-muted mb-0\",children:\"No department data available\"})})})]})})]})]});};export default AdminDashboard;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}