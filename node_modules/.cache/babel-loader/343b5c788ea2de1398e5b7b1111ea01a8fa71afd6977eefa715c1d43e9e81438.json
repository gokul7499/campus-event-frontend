{"ast":null,"code":"import _objectSpread from\"C:/Users/Baap/Desktop/campus-event-management/campus-event-frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect}from'react';import{Container,Row,Col,Card,Badge,Button,Table,ListGroup}from'react-bootstrap';import{Link}from'react-router-dom';import axios from'../../utils/axios';import{useAuth}from'../../context/AuthContext';import LoadingSpinner from'../../components/common/LoadingSpinner';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const OrganizerDashboard=()=>{const{user}=useAuth();const[dashboardData,setDashboardData]=useState({events:[],upcomingEvents:[],recentRegistrations:[],popularEvents:[],monthlyTrends:[],stats:{totalEvents:0,upcomingEvents:0,pastEvents:0,draftEvents:0,publishedEvents:0,totalRegistrations:0,pendingRegistrations:0,confirmedRegistrations:0,totalAttendees:0},notifications:[]});const[loading,setLoading]=useState(true);const[creatingData,setCreatingData]=useState(false);useEffect(()=>{if(user){fetchDashboardData();}},[user]);const fetchDashboardData=async()=>{try{setLoading(true);console.log('Fetching organizer dashboard data...');// Try to fetch from organizer dashboard API\ntry{const dashboardRes=await axios.get('/api/dashboard/organizer');const data=dashboardRes.data.data;console.log('Organizer dashboard API response:',data);setDashboardData({events:data.events||[],upcomingEvents:data.upcomingEvents||[],recentRegistrations:data.recentRegistrations||[],popularEvents:data.popularEvents||[],monthlyTrends:data.monthlyTrends||[],stats:data.stats||{totalEvents:0,upcomingEvents:0,pastEvents:0,draftEvents:0,publishedEvents:0,totalRegistrations:0,pendingRegistrations:0,confirmedRegistrations:0,totalAttendees:0},notifications:data.notifications||[]});console.log('Organizer dashboard data loaded successfully');}catch(dashboardError){console.log('Dashboard API failed:',dashboardError.message);// Fallback: try to fetch events directly\ntry{var _eventsRes$value,_eventsRes$value$data;const eventsRes=await axios.get('/api/events/my/events');const events=((_eventsRes$value=eventsRes.value)===null||_eventsRes$value===void 0?void 0:(_eventsRes$value$data=_eventsRes$value.data)===null||_eventsRes$value$data===void 0?void 0:_eventsRes$value$data.data)||[];setDashboardData(prev=>_objectSpread(_objectSpread({},prev),{},{events:events.slice(0,10),upcomingEvents:events.filter(e=>new Date(e.startDate)>new Date()).slice(0,5),stats:_objectSpread(_objectSpread({},prev.stats),{},{totalEvents:events.length,upcomingEvents:events.filter(e=>new Date(e.startDate)>new Date()).length,publishedEvents:events.filter(e=>e.status==='published').length,draftEvents:events.filter(e=>e.status==='draft').length})}));}catch(eventsError){console.log('Events API also failed, using mock data');// Mock data is already set in backend\n}}}catch(error){console.error('Error fetching organizer dashboard data:',error);}finally{setLoading(false);}};const getStatusBadge=status=>{const statusMap={published:{bg:'success',text:'Published'},draft:{bg:'secondary',text:'Draft'},cancelled:{bg:'danger',text:'Cancelled'},completed:{bg:'info',text:'Completed'}};const config=statusMap[status]||{bg:'secondary',text:status};return/*#__PURE__*/_jsx(Badge,{bg:config.bg,children:config.text});};const getRegistrationStatusBadge=status=>{const statusMap={confirmed:{bg:'success',text:'Confirmed'},pending:{bg:'warning',text:'Pending'},waitlisted:{bg:'info',text:'Waitlisted'},cancelled:{bg:'danger',text:'Cancelled'},attended:{bg:'primary',text:'Attended'}};const config=statusMap[status]||{bg:'secondary',text:status};return/*#__PURE__*/_jsx(Badge,{bg:config.bg,children:config.text});};const formatDate=dateString=>{return new Date(dateString).toLocaleDateString('en-US',{weekday:'short',month:'short',day:'numeric',hour:'2-digit',minute:'2-digit'});};const createSampleData=async()=>{try{setCreatingData(true);const response=await axios.post('/api/dashboard/create-organizer-data');if(response.data.success){// Refresh dashboard data\nawait fetchDashboardData();alert(\"Success! Created \".concat(response.data.data.eventsCreated,\" sample events. Dashboard updated!\"));}}catch(error){console.error('Error creating organizer sample data:',error);alert('Failed to create sample data. Please try again.');}finally{setCreatingData(false);}};if(loading){return/*#__PURE__*/_jsx(LoadingSpinner,{fullScreen:true,text:\"Loading organizer dashboard...\"});}return/*#__PURE__*/_jsxs(Container,{className:\"py-4\",children:[/*#__PURE__*/_jsx(Row,{className:\"mb-4\",children:/*#__PURE__*/_jsx(Col,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex justify-content-between align-items-center\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"h1\",{className:\"mb-1\",children:[\"Welcome back, \",(user===null||user===void 0?void 0:user.firstName)||'Organizer',\"!\"]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-muted mb-0\",children:\"Manage your events and track registrations\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex gap-2\",children:[/*#__PURE__*/_jsxs(Button,{variant:\"outline-primary\",onClick:fetchDashboardData,children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-arrow-clockwise me-2\"}),\"Refresh\"]}),dashboardData.stats.totalEvents===0&&/*#__PURE__*/_jsx(Button,{variant:\"outline-success\",onClick:createSampleData,disabled:creatingData,children:creatingData?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"span\",{className:\"spinner-border spinner-border-sm me-2\",role:\"status\"}),\"Creating...\"]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-plus-circle me-2\"}),\"Create Sample Events\"]})}),/*#__PURE__*/_jsxs(Button,{variant:\"primary\",as:Link,to:\"/create-event\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-plus-circle me-2\"}),\"Create Event\"]})]})]})})}),/*#__PURE__*/_jsxs(Row,{className:\"mb-4\",children:[/*#__PURE__*/_jsx(Col,{lg:3,md:6,className:\"mb-3\",children:/*#__PURE__*/_jsx(Card,{className:\"border-0 shadow-sm h-100\",children:/*#__PURE__*/_jsx(Card.Body,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex align-items-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"flex-shrink-0\",children:/*#__PURE__*/_jsx(\"div\",{className:\"bg-primary bg-opacity-10 rounded-circle p-3\",children:/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-calendar-event text-primary\",style:{fontSize:'1.5rem'}})})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-grow-1 ms-3\",children:[/*#__PURE__*/_jsx(\"h6\",{className:\"text-muted mb-1\",children:\"Total Events\"}),/*#__PURE__*/_jsx(\"h3\",{className:\"mb-0\",children:dashboardData.stats.totalEvents})]})]})})})}),/*#__PURE__*/_jsx(Col,{lg:3,md:6,className:\"mb-3\",children:/*#__PURE__*/_jsx(Card,{className:\"border-0 shadow-sm h-100\",children:/*#__PURE__*/_jsx(Card.Body,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex align-items-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"flex-shrink-0\",children:/*#__PURE__*/_jsx(\"div\",{className:\"bg-success bg-opacity-10 rounded-circle p-3\",children:/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-clock text-success\",style:{fontSize:'1.5rem'}})})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-grow-1 ms-3\",children:[/*#__PURE__*/_jsx(\"h6\",{className:\"text-muted mb-1\",children:\"Upcoming Events\"}),/*#__PURE__*/_jsx(\"h3\",{className:\"mb-0\",children:dashboardData.stats.upcomingEvents})]})]})})})}),/*#__PURE__*/_jsx(Col,{lg:3,md:6,className:\"mb-3\",children:/*#__PURE__*/_jsx(Card,{className:\"border-0 shadow-sm h-100\",children:/*#__PURE__*/_jsx(Card.Body,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex align-items-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"flex-shrink-0\",children:/*#__PURE__*/_jsx(\"div\",{className:\"bg-info bg-opacity-10 rounded-circle p-3\",children:/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-people text-info\",style:{fontSize:'1.5rem'}})})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-grow-1 ms-3\",children:[/*#__PURE__*/_jsx(\"h6\",{className:\"text-muted mb-1\",children:\"Total Registrations\"}),/*#__PURE__*/_jsx(\"h3\",{className:\"mb-0\",children:dashboardData.stats.totalRegistrations})]})]})})})}),/*#__PURE__*/_jsx(Col,{lg:3,md:6,className:\"mb-3\",children:/*#__PURE__*/_jsx(Card,{className:\"border-0 shadow-sm h-100\",children:/*#__PURE__*/_jsx(Card.Body,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex align-items-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"flex-shrink-0\",children:/*#__PURE__*/_jsx(\"div\",{className:\"bg-warning bg-opacity-10 rounded-circle p-3\",children:/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-hourglass-split text-warning\",style:{fontSize:'1.5rem'}})})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-grow-1 ms-3\",children:[/*#__PURE__*/_jsx(\"h6\",{className:\"text-muted mb-1\",children:\"Pending Approvals\"}),/*#__PURE__*/_jsx(\"h3\",{className:\"mb-0\",children:dashboardData.stats.pendingRegistrations})]})]})})})})]}),/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{lg:8,className:\"mb-4\",children:/*#__PURE__*/_jsxs(Card,{className:\"border-0 shadow-sm h-100\",children:[/*#__PURE__*/_jsxs(Card.Header,{className:\"bg-white border-0 py-3 d-flex justify-content-between align-items-center\",children:[/*#__PURE__*/_jsx(\"h5\",{className:\"mb-0\",children:\"Your Recent Events\"}),/*#__PURE__*/_jsx(Button,{variant:\"outline-primary\",size:\"sm\",as:Link,to:\"/manage-events\",children:\"View All Events\"})]}),/*#__PURE__*/_jsx(Card.Body,{className:\"p-0\",children:dashboardData.events.length>0?/*#__PURE__*/_jsx(\"div\",{className:\"table-responsive\",children:/*#__PURE__*/_jsxs(Table,{hover:true,className:\"mb-0\",children:[/*#__PURE__*/_jsx(\"thead\",{className:\"table-light\",children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"Event\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Date\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Status\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Registrations\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Actions\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:dashboardData.events.slice(0,5).map(event=>{var _event$venue;return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h6\",{className:\"mb-1\",children:event.title}),/*#__PURE__*/_jsx(\"small\",{className:\"text-muted\",children:((_event$venue=event.venue)===null||_event$venue===void 0?void 0:_event$venue.name)||'No venue specified'})]})}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"small\",{children:formatDate(event.startDate)})}),/*#__PURE__*/_jsx(\"td\",{children:getStatusBadge(event.status)}),/*#__PURE__*/_jsxs(\"td\",{children:[/*#__PURE__*/_jsx(\"span\",{className:\"fw-bold\",children:event.registrationCount||0}),/*#__PURE__*/_jsxs(\"small\",{className:\"text-muted\",children:[\"/\",event.maxAttendees||'N/A']})]}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex gap-1\",children:[/*#__PURE__*/_jsx(Button,{variant:\"outline-primary\",size:\"sm\",as:Link,to:\"/events/\".concat(event._id),children:\"View\"}),/*#__PURE__*/_jsx(Button,{variant:\"outline-secondary\",size:\"sm\",as:Link,to:\"/edit-event/\".concat(event._id),children:\"Edit\"})]})})]},event._id);})})]})}):/*#__PURE__*/_jsxs(\"div\",{className:\"text-center py-5\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-calendar-x text-muted\",style:{fontSize:'3rem'}}),/*#__PURE__*/_jsx(\"h5\",{className:\"mt-3\",children:\"No Events Yet\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-muted\",children:\"Create your first event to get started!\"}),/*#__PURE__*/_jsxs(Button,{variant:\"primary\",as:Link,to:\"/create-event\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-plus-circle me-2\"}),\"Create Event\"]})]})})]})}),/*#__PURE__*/_jsxs(Col,{lg:4,children:[/*#__PURE__*/_jsxs(Card,{className:\"border-0 shadow-sm mb-4\",children:[/*#__PURE__*/_jsx(Card.Header,{className:\"bg-white border-0 py-3\",children:/*#__PURE__*/_jsx(\"h6\",{className:\"mb-0\",children:\"Recent Registrations\"})}),/*#__PURE__*/_jsx(Card.Body,{children:dashboardData.recentRegistrations.length>0?/*#__PURE__*/_jsx(ListGroup,{variant:\"flush\",children:dashboardData.recentRegistrations.slice(0,5).map(registration=>{var _registration$partici,_registration$partici2,_registration$event;return/*#__PURE__*/_jsx(ListGroup.Item,{className:\"px-0 py-2\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex justify-content-between align-items-start\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex-grow-1\",children:[/*#__PURE__*/_jsxs(\"h6\",{className:\"mb-1 small\",children:[(_registration$partici=registration.participant)===null||_registration$partici===void 0?void 0:_registration$partici.firstName,\" \",(_registration$partici2=registration.participant)===null||_registration$partici2===void 0?void 0:_registration$partici2.lastName]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-muted mb-1 small\",children:(_registration$event=registration.event)===null||_registration$event===void 0?void 0:_registration$event.title}),/*#__PURE__*/_jsx(\"small\",{className:\"text-muted\",children:new Date(registration.createdAt).toLocaleDateString()})]}),/*#__PURE__*/_jsx(\"div\",{className:\"text-end\",children:getRegistrationStatusBadge(registration.status)})]})},registration._id);})}):/*#__PURE__*/_jsx(\"p\",{className:\"text-muted small\",children:\"No recent registrations\"})})]}),/*#__PURE__*/_jsxs(Card,{className:\"border-0 shadow-sm\",children:[/*#__PURE__*/_jsx(Card.Header,{className:\"bg-white border-0 py-3\",children:/*#__PURE__*/_jsx(\"h6\",{className:\"mb-0\",children:\"Quick Actions\"})}),/*#__PURE__*/_jsx(Card.Body,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"d-grid gap-2\",children:[/*#__PURE__*/_jsxs(Button,{variant:\"primary\",as:Link,to:\"/create-event\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-plus-circle me-2\"}),\"Create New Event\"]}),/*#__PURE__*/_jsxs(Button,{variant:\"outline-primary\",as:Link,to:\"/manage-events\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-calendar-check me-2\"}),\"Manage Events\"]}),/*#__PURE__*/_jsxs(Button,{variant:\"outline-success\",as:Link,to:\"/admin/participants\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-people me-2\"}),\"View Participants\"]}),/*#__PURE__*/_jsxs(Button,{variant:\"outline-info\",as:Link,to:\"/admin/notifications\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-bell me-2\"}),\"Send Notifications\"]})]})})]})]})]})]});};export default OrganizerDashboard;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}