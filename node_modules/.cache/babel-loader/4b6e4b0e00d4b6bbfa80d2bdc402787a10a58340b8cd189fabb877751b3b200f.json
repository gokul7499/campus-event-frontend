{"ast":null,"code":"import _objectSpread from\"C:/Users/Baap/Desktop/campus-event-management/campus-event-frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect}from'react';import{Container,Row,Col,Card,Form,Button,Tab,Tabs,Modal}from'react-bootstrap';import{toast}from'react-toastify';import{useAuth}from'../../context/AuthContext';import axios from'../../utils/axios';import LoadingSpinner from'../../components/common/LoadingSpinner';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const ProfilePage=()=>{var _user$role,_user$role2;const{user,updateProfile,updatePassword}=useAuth();const[loading,setLoading]=useState(false);const[activeTab,setActiveTab]=useState('profile');const[showPasswordModal,setShowPasswordModal]=useState(false);// Profile form state\nconst[profileData,setProfileData]=useState({firstName:'',lastName:'',email:'',phone:'',bio:'',department:'',year:'',interests:[]});// Password form state\nconst[passwordData,setPasswordData]=useState({currentPassword:'',newPassword:'',confirmPassword:''});// Notification preferences\nconst[notifications,setNotifications]=useState({emailNotifications:true,smsNotifications:false,eventReminders:true,eventUpdates:true,marketingEmails:false});useEffect(()=>{if(user){setProfileData({firstName:user.firstName||'',lastName:user.lastName||'',email:user.email||'',phone:user.phone||'',bio:user.bio||'',department:user.department||'',year:user.year||'',interests:user.interests||[]});}},[user]);const handleProfileSubmit=async e=>{e.preventDefault();setLoading(true);try{const result=await updateProfile(profileData);if(result.success){toast.success('Profile updated successfully!');}else{toast.error(result.error||'Failed to update profile');}}catch(error){toast.error('Failed to update profile');}finally{setLoading(false);}};const handlePasswordSubmit=async e=>{e.preventDefault();if(passwordData.newPassword!==passwordData.confirmPassword){toast.error('New passwords do not match');return;}if(passwordData.newPassword.length<6){toast.error('Password must be at least 6 characters long');return;}setLoading(true);try{const result=await updatePassword({passwordCurrent:passwordData.currentPassword,password:passwordData.newPassword});if(result.success){toast.success('Password updated successfully!');setPasswordData({currentPassword:'',newPassword:'',confirmPassword:''});setShowPasswordModal(false);}else{toast.error(result.error||'Failed to update password');}}catch(error){toast.error('Failed to update password');}finally{setLoading(false);}};const handleNotificationUpdate=async()=>{setLoading(true);try{await axios.put('/api/auth/notifications',notifications);toast.success('Notification preferences updated!');}catch(error){toast.error('Failed to update notification preferences');}finally{setLoading(false);}};if(!user){return/*#__PURE__*/_jsx(LoadingSpinner,{});}return/*#__PURE__*/_jsxs(Container,{className:\"py-4\",children:[/*#__PURE__*/_jsx(Row,{children:/*#__PURE__*/_jsx(Col,{children:/*#__PURE__*/_jsx(\"h1\",{className:\"mb-4\",children:\"My Profile\"})})}),/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{lg:3,children:/*#__PURE__*/_jsx(Card,{className:\"mb-4\",children:/*#__PURE__*/_jsxs(Card.Body,{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"mb-3\",children:/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-person-circle text-primary\",style:{fontSize:'4rem'}})}),/*#__PURE__*/_jsxs(\"h5\",{children:[user.firstName,\" \",user.lastName]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-muted\",children:user.email}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-muted\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-shield-check me-1\"}),((_user$role=user.role)===null||_user$role===void 0?void 0:_user$role.charAt(0).toUpperCase())+((_user$role2=user.role)===null||_user$role2===void 0?void 0:_user$role2.slice(1))]}),/*#__PURE__*/_jsxs(Button,{variant:\"outline-primary\",size:\"sm\",onClick:()=>setShowPasswordModal(true),children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-key me-1\"}),\"Change Password\"]})]})})}),/*#__PURE__*/_jsx(Col,{lg:9,children:/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsx(Card.Body,{children:/*#__PURE__*/_jsxs(Tabs,{activeKey:activeTab,onSelect:k=>setActiveTab(k),className:\"mb-3\",children:[/*#__PURE__*/_jsx(Tab,{eventKey:\"profile\",title:\"Profile Information\",children:/*#__PURE__*/_jsxs(Form,{onSubmit:handleProfileSubmit,children:[/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{md:6,children:/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"First Name\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"text\",value:profileData.firstName,onChange:e=>setProfileData(_objectSpread(_objectSpread({},profileData),{},{firstName:e.target.value})),required:true})]})}),/*#__PURE__*/_jsx(Col,{md:6,children:/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Last Name\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"text\",value:profileData.lastName,onChange:e=>setProfileData(_objectSpread(_objectSpread({},profileData),{},{lastName:e.target.value})),required:true})]})})]}),/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{md:6,children:/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Email\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"email\",value:profileData.email,onChange:e=>setProfileData(_objectSpread(_objectSpread({},profileData),{},{email:e.target.value})),required:true})]})}),/*#__PURE__*/_jsx(Col,{md:6,children:/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Phone\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"tel\",value:profileData.phone,onChange:e=>setProfileData(_objectSpread(_objectSpread({},profileData),{},{phone:e.target.value}))})]})})]}),/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{md:6,children:/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Department\"}),/*#__PURE__*/_jsxs(Form.Select,{value:profileData.department,onChange:e=>setProfileData(_objectSpread(_objectSpread({},profileData),{},{department:e.target.value})),children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Select Department\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Computer Science\",children:\"Computer Science\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Engineering\",children:\"Engineering\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Business\",children:\"Business\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Arts\",children:\"Arts\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Sciences\",children:\"Sciences\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Medicine\",children:\"Medicine\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Law\",children:\"Law\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Other\",children:\"Other\"})]})]})}),/*#__PURE__*/_jsx(Col,{md:6,children:/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Year\"}),/*#__PURE__*/_jsxs(Form.Select,{value:profileData.year,onChange:e=>setProfileData(_objectSpread(_objectSpread({},profileData),{},{year:e.target.value})),children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Select Year\"}),/*#__PURE__*/_jsx(\"option\",{value:\"1st Year\",children:\"1st Year\"}),/*#__PURE__*/_jsx(\"option\",{value:\"2nd Year\",children:\"2nd Year\"}),/*#__PURE__*/_jsx(\"option\",{value:\"3rd Year\",children:\"3rd Year\"}),/*#__PURE__*/_jsx(\"option\",{value:\"4th Year\",children:\"4th Year\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Graduate\",children:\"Graduate\"}),/*#__PURE__*/_jsx(\"option\",{value:\"PhD\",children:\"PhD\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Faculty\",children:\"Faculty\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Staff\",children:\"Staff\"})]})]})})]}),/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Bio\"}),/*#__PURE__*/_jsx(Form.Control,{as:\"textarea\",rows:3,value:profileData.bio,onChange:e=>setProfileData(_objectSpread(_objectSpread({},profileData),{},{bio:e.target.value})),placeholder:\"Tell us about yourself...\"})]}),/*#__PURE__*/_jsx(Button,{type:\"submit\",variant:\"primary\",disabled:loading,children:loading?'Updating...':'Update Profile'})]})}),/*#__PURE__*/_jsxs(Tab,{eventKey:\"notifications\",title:\"Notifications\",children:[/*#__PURE__*/_jsx(\"h5\",{className:\"mb-3\",children:\"Notification Preferences\"}),/*#__PURE__*/_jsx(Form.Check,{type:\"switch\",id:\"email-notifications\",label:\"Email Notifications\",checked:notifications.emailNotifications,onChange:e=>setNotifications(_objectSpread(_objectSpread({},notifications),{},{emailNotifications:e.target.checked})),className:\"mb-3\"}),/*#__PURE__*/_jsx(Form.Check,{type:\"switch\",id:\"event-reminders\",label:\"Event Reminders\",checked:notifications.eventReminders,onChange:e=>setNotifications(_objectSpread(_objectSpread({},notifications),{},{eventReminders:e.target.checked})),className:\"mb-3\"}),/*#__PURE__*/_jsx(Form.Check,{type:\"switch\",id:\"event-updates\",label:\"Event Updates\",checked:notifications.eventUpdates,onChange:e=>setNotifications(_objectSpread(_objectSpread({},notifications),{},{eventUpdates:e.target.checked})),className:\"mb-3\"}),/*#__PURE__*/_jsx(Form.Check,{type:\"switch\",id:\"marketing-emails\",label:\"Marketing Emails\",checked:notifications.marketingEmails,onChange:e=>setNotifications(_objectSpread(_objectSpread({},notifications),{},{marketingEmails:e.target.checked})),className:\"mb-3\"}),/*#__PURE__*/_jsx(Button,{variant:\"primary\",onClick:handleNotificationUpdate,disabled:loading,children:loading?'Updating...':'Save Preferences'})]})]})})})})]}),/*#__PURE__*/_jsxs(Modal,{show:showPasswordModal,onHide:()=>setShowPasswordModal(false),children:[/*#__PURE__*/_jsx(Modal.Header,{closeButton:true,children:/*#__PURE__*/_jsx(Modal.Title,{children:\"Change Password\"})}),/*#__PURE__*/_jsx(Modal.Body,{children:/*#__PURE__*/_jsxs(Form,{onSubmit:handlePasswordSubmit,children:[/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Current Password\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"password\",value:passwordData.currentPassword,onChange:e=>setPasswordData(_objectSpread(_objectSpread({},passwordData),{},{currentPassword:e.target.value})),required:true})]}),/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"New Password\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"password\",value:passwordData.newPassword,onChange:e=>setPasswordData(_objectSpread(_objectSpread({},passwordData),{},{newPassword:e.target.value})),required:true,minLength:6})]}),/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Confirm New Password\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"password\",value:passwordData.confirmPassword,onChange:e=>setPasswordData(_objectSpread(_objectSpread({},passwordData),{},{confirmPassword:e.target.value})),required:true,minLength:6})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex justify-content-end gap-2\",children:[/*#__PURE__*/_jsx(Button,{variant:\"secondary\",onClick:()=>setShowPasswordModal(false),children:\"Cancel\"}),/*#__PURE__*/_jsx(Button,{type:\"submit\",variant:\"primary\",disabled:loading,children:loading?'Updating...':'Update Password'})]})]})})]})]});};export default ProfilePage;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}